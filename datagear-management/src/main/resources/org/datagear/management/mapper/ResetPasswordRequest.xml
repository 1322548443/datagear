<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.datagear.management.domain.ResetPasswordRequest">

	<insert id="insert">
		INSERT INTO DATAGEAR_RESET_PSD_REQUEST
			(
			RESET_PSD_REQ_ID, RESET_PSD_USER_ID, RESET_PSD_PASSWORD, RESET_PSD_TIME, RESET_PSD_PRINCIPAL
			)
		VALUES
			(
			#{entity.id}, #{entity.user.id}, #{entity.password}, #{entity.time}, #{entity.principal}
			)
	</insert>
	
	<delete id="deleteById">
		DELETE FROM DATAGEAR_RESET_PSD_REQUEST
		WHERE
			RESET_PSD_REQ_ID = #{id}
	</delete>
	
	<select id="getByUserId" resultType="org.datagear.management.domain.ResetPasswordRequest">
		SELECT
			T.*
		FROM
			(<include refid="queryView" />) T
		WHERE
			T.${_iq_}user.id${_iq_} = #{userId}
	</select>
	
	<select id="getAll" resultType="org.datagear.management.domain.ResetPasswordRequest">
		SELECT
			T.*
		FROM
			(<include refid="queryView" />) T
	</select>
	
	<sql id="queryView">
		SELECT
			A.RESET_PSD_REQ_ID AS ${_iq_}id${_iq_},
			A.RESET_PSD_USER_ID AS ${_iq_}user.id${_iq_},
			A.RESET_PSD_PASSWORD AS ${_iq_}password${_iq_},
			A.RESET_PSD_TIME AS ${_iq_}time${_iq_},
			A.RESET_PSD_PRINCIPAL AS ${_iq_}principal${_iq_},
			B.USER_NAME AS ${_iq_}user.name${_iq_},
			B.USER_REAL_NAME AS ${_iq_}user.realName${_iq_}
		FROM
			DATAGEAR_RESET_PSD_REQUEST A,
			DATAGEAR_USER B
		WHERE
			A.RESET_PSD_USER_ID = B.USER_ID
	</sql>
</mapper>